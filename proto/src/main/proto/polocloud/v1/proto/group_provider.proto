syntax = "proto3";

package dev.httpmarco.polocloud.v1.proto;

option java_package = "dev.httpmarco.polocloud.v1.groups";
option java_multiple_files = true;

import "polocloud/v1/proto/object_utils.proto";
import "google/protobuf/struct.proto";

service GroupController {
  rpc find(FindGroupRequest) returns (FindGroupResponse);
  rpc create(GroupCreateRequest) returns (GroupCreateResponse);
  rpc update(GroupUpdateRequest) returns (GroupUpdateResponse);
  rpc delete(GroupDeleteRequest) returns (GroupDeleteResponse);
}

message FindGroupRequest {
  string name = 1;
  GroupType type = 2;
}

message FindGroupResponse {
  repeated GroupSnapshot groups = 1;
}

message GroupCreateRequest {
  string name = 1;
  GroupType type = 2;
  PlatformSnapshot platform = 3;
  int32 minimumMemory = 4;
  int32 maximumMemory = 5;
  int32 minimumOnline = 6;
  int32 maximumOnline = 7;
  double percentageToStartNewService = 8;
  repeated string templates = 9;
  map<string, string> properties = 10;
}

message GroupCreateResponse {
  GroupSnapshot group = 1;
}

message GroupUpdateRequest {
  string name = 1;
  GroupType type = 2;
  PlatformSnapshot platform = 3;
  int32 minimumMemory = 4;
  int32 maximumMemory = 5;
  int32 minimumOnline = 6;
  int32 maximumOnline = 7;
  double percentageToStartNewService = 8;
  GroupInformationSnapshot information = 9;
  repeated string templates = 10;
  map<string, string> properties = 11;
}

message GroupUpdateResponse {
  GroupSnapshot group = 1;
}

message GroupDeleteRequest {
  string name = 1;
}

message GroupDeleteResponse {
  GroupSnapshot group = 1;
}

message GroupSnapshot {
  string name = 1;
  GroupType type = 2;
  PlatformSnapshot platform = 3;
  int32 minimumMemory = 4;
  int32 maximumMemory = 5;
  int32 minimumOnline = 6;
  int32 maximumOnline = 7;
  double percentageToStartNewService = 8;
  GroupInformationSnapshot information = 9;
  repeated string templates = 10;
  map<string, string> properties = 11;
}

message GroupInformationSnapshot {
  int64 createdAt = 1;
}

message PlatformSnapshot {
  string name = 2;
  string version = 1;
}